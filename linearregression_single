import pandas as pd
import numpy as np
from sklearn import linear_model
import matplotlib.pyplot as plt
df=pd.read_csv("D:\\Users\\User\\anaconda\\ml\\lin_ex.csv")
df
year	per capita income (US$)
0	1970	3399.299037
1	1971	3768.297935
2	1972	4251.175484
3	1973	4804.463248
4	1974	5576.514583
5	1975	5998.144346
6	1976	7062.131392
7	1977	7100.126170
8	1978	7247.967035
9	1979	7602.912681
10	1980	8355.968120
11	1981	9434.390652
12	1982	9619.438377
13	1983	10416.536590
14	1984	10790.328720
15	1985	11018.955850
16	1986	11482.891530
17	1987	12974.806620
18	1988	15080.283450
19	1989	16426.725480
20	1990	16838.673200
21	1991	17266.097690
22	1992	16799.988010
23	1993	17444.587250
24	1994	18089.186490
25	1995	18733.785730
26	1996	19378.384970
27	1997	20022.984210
28	1998	20667.583450
29	1999	21312.182690
30	2000	21956.781930
31	2001	22601.381170
32	2002	23245.980410
33	2003	23890.579660
34	2004	24535.178900
35	2005	25179.778140
36	2006	25824.377380
37	2007	26468.976620
38	2008	27113.575860
39	2009	27758.175100
40	2010	28402.774340
41	2011	29047.373580
42	2012	29691.972820
43	2013	30336.572060
44	2014	30981.171310
45	2015	31625.770550
46	2016	32270.369790
new_df=df.drop('per capita income (US$)',axis='columns')
new_df
year
0	1970
1	1971
2	1972
3	1973
4	1974
5	1975
6	1976
7	1977
8	1978
9	1979
10	1980
11	1981
12	1982
13	1983
14	1984
15	1985
16	1986
17	1987
18	1988
19	1989
20	1990
21	1991
22	1992
23	1993
24	1994
25	1995
26	1996
27	1997
28	1998
29	1999
30	2000
31	2001
32	2002
33	2003
34	2004
35	2005
36	2006
37	2007
38	2008
39	2009
40	2010
41	2011
42	2012
43	2013
44	2014
45	2015
46	2016

income=(df[['per capita income (US$)']])
income
per capita income (US$)
0	3399.299037
1	3768.297935
2	4251.175484
3	4804.463248
4	5576.514583
5	5998.144346
6	7062.131392
7	7100.126170
8	7247.967035
9	7602.912681
10	8355.968120
11	9434.390652
12	9619.438377
13	10416.536590
14	10790.328720
15	11018.955850
16	11482.891530
17	12974.806620
18	15080.283450
19	16426.725480
20	16838.673200
21	17266.097690
22	16799.988010
23	17444.587250
24	18089.186490
25	18733.785730
26	19378.384970
27	20022.984210
28	20667.583450
29	21312.182690
30	21956.781930
31	22601.381170
32	23245.980410
33	23890.579660
34	24535.178900
35	25179.778140
36	25824.377380
37	26468.976620
38	27113.575860
39	27758.175100
40	28402.774340
41	29047.373580
42	29691.972820
43	30336.572060
44	30981.171310
45	31625.770550
46	32270.369790
reg=linear_model.LinearRegression()
reg.fit(new_df,income)
LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)
reg.predict([[2020]])
array([[34848.7667508]])
Type Markdown and LaTeX: ùõº2
plt.xlabel('year')
plt.ylabel('per capita income (US$)')
plt.scatter(new_df,income,color='red',marker='+')
<matplotlib.collections.PathCollection at 0xb89fb70>

reg.coef_
‚Äã
array([[644.59924088]])
reg.intercept_
array([-1267241.69982815])
2020*644.59924088+-1267241.69982815
34848.766749450006
